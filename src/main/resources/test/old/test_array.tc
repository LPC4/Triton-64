import memory

func main() {
    ; Basic usage
    var ptr = malloc(40)      ; Allocate 5 * 8 bytes
    @ptr = [1, 2, 3, 4, 5]    ; Store array literal
    
    ; Array indexing
    var first = ptr[0]        ; Gets 1
    var second = ptr[1]       ; Gets 2
    ptr[2] = 100              ; Sets 3rd element to 100

    var sum = ptr[0] + ptr[1] ; 1 + 2 = 3
    ptr[4] = ptr[0] * 10      ; Sets last element to 10

    var alt = @(ptr + 16)     ; Same as ptr[2]

    var arrBase = malloc(32)     ; Allocate 2 * 8 bytes
    var arrChild1 = malloc(16)  ; Allocate 2 * 8 bytes
    var arrChild2 = malloc(16)  ; Allocate 2 * 8 bytes
    @arrBase = [arrChild1, arrChild2] ; Store child pointers
    @arrChild1 = [10, 20]      ; Store values in first child
    @arrChild2 = [30, 40]      ; Store values in second child

    var child1First = arrBase[0][0] ; Gets 10
    var child2Second = arrBase[1][1] ; Gets 40


    return child1First + child2Second ; Returns 10 + 40 = 50
}